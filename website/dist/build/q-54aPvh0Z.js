import{R as i,a as l,s as r,t as e,q as c}from"./q-dgQLQ9M1.js";import{u as h}from"./q-CyNgVds-.js";import{L as s}from"./q-BuauhHiJ.js";const d="/assets/BSLltHWw-issue-type-dark.webp 200w, /assets/CiBx-Bvs-issue-type-dark.webp 400w, /assets/BhaHHahD-issue-type-dark.webp 600w, /assets/z9f53xBm-issue-type-dark.webp 800w, /assets/Up204Jm2-issue-type-dark.webp 1200w",p=1200,u=386,m={srcSet:d,width:p,height:u};function y(t,n,a,o){return i("img",{decoding:"async",loading:"lazy",...t},m,void 0,3,n)}const f="/assets/BYx1j7R5-issue-type-light.webp 200w, /assets/D9L1sHxa-issue-type-light.webp 400w, /assets/DZFCXsSF-issue-type-light.webp 600w, /assets/D6UzmAV3-issue-type-light.webp 800w, /assets/DxAc8o0I-issue-type-light.webp 1200w",k=1200,b=386,g={srcSet:f,width:k,height:b};function w(t,n,a,o){return i("img",{decoding:"async",loading:"lazy",...t},g,void 0,3,n)}const v="/assets/usRscDQ7-mental-model-dark.webp 200w, /assets/AwO-Tya4-mental-model-dark.webp 400w, /assets/BVjQfmjC-mental-model-dark.webp 600w, /assets/Bv8SXlDW-mental-model-dark.webp 800w, /assets/qQbqZbLX-mental-model-dark.webp 1200w",x=1200,z=496,S={srcSet:v,width:x,height:z};function D(t,n,a,o){return i("img",{decoding:"async",loading:"lazy",...t},S,void 0,3,n)}const I="/assets/B9Yv5XIg-mental-model-light.webp 200w, /assets/C-pagTGj-mental-model-light.webp 400w, /assets/BF4PcLtl-mental-model-light.webp 600w, /assets/DCmpzYoY-mental-model-light.webp 800w, /assets/DLeLseBR-mental-model-light.webp 1200w",T=1200,A=496,P={srcSet:I,width:T,height:A};function $(t,n,a,o){return i("img",{decoding:"async",loading:"lazy",...t},P,void 0,3,n)}const B="/assets/BL3b84aC-string-size-dark.webp 200w, /assets/DVmg5J36-string-size-dark.webp 400w, /assets/640rLNVz-string-size-dark.webp 600w, /assets/Dlc1f-N2-string-size-dark.webp 800w, /assets/B1UhEGZH-string-size-dark.webp 1200w",L=1200,C=474,V={srcSet:B,width:L,height:C};function F(t,n,a,o){return i("img",{decoding:"async",loading:"lazy",...t},V,void 0,3,n)}const M="/assets/BVp1ulFo-string-size-light.webp 200w, /assets/Duwm3H8X-string-size-light.webp 400w, /assets/CGST9inu-string-size-light.webp 600w, /assets/DqrHooHO-string-size-light.webp 800w, /assets/DWvu_S04-string-size-light.webp 1200w",j=1200,q=474,W={srcSet:M,width:j,height:q};function H(t,n,a,o){return i("img",{decoding:"async",loading:"lazy",...t},W,void 0,3,n)}const X=[{text:"Mental model",id:"mental-model",level:2},{text:"Bundle Size",id:"bundle-size",level:2},{text:"Flexibility",id:"flexibility",level:2},{text:"Type safety",id:"type-safety",level:2},{text:"Stability",id:"stability",level:2},{text:"Thank you!",id:"thank-you",level:2}],E={title:"Valibot v0.31.0 is finally available",meta:[{name:"description",content:"After 3 months of hard work I am happy to announce that Valibot v0.31.0 is finally available."}],styles:[],links:[],scripts:[],frontmatter:{cover:"v0.31.0",published:"2024-06-06",authors:["fabian-hiller"]}},Y={cover:"v0.31.0",title:"Valibot v0.31.0 is finally available",description:"After 3 months of hard work I am happy to announce that Valibot v0.31.0 is finally available.",published:"2024-06-06",authors:["fabian-hiller"]};function R(t){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",p:"p",pre:"pre",span:"span",strong:"strong",...h(),...t.components};return e(c,{children:[e(n.p,{children:"After 3 months of hard work I am happy to announce that Valibot v0.31.0 is finally available. This is not a regular release as we have rewritten the whole library from scratch."}),`
`,e(n.p,{children:"Based on your feedback and all the lessons learned from the past, we were able to drastically improve the mental model, bundle size, flexibility, type safety and stability of the library. I would like to highlight some of the major improvements and changes in this post."}),`
`,e(n.blockquote,{children:[`
`,e(n.p,{children:["Because this release introduces some breaking changes, we put a lot of effort into making the migration experience as smooth as possible. I worked closely with the open source community to create a detailed ",e(s,{href:"/guides/migrate-to-v0.31.0/",children:"migration guide"})," and two codemods to automatically update your schemas."]}),`
`]}),`
`,e(n.h2,{id:"mental-model",children:[e(n.a,{"aria-hidden":"true",tabindex:"-1",href:"#mental-model",children:e(n.span,{class:"icon icon-link"})}),"Mental model"]}),`
`,e(n.p,{children:"We believe that Valibot will be easier to use because we have drastically improved the mental model. For a modular library like Valibot, this is crucial, as each functionality is imported as its own function."}),`
`,e(n.p,{children:["The mental model is now reduced to ",e(n.strong,{children:"schemas"}),", ",e(n.strong,{children:"methods"})," and ",e(n.strong,{children:"actions"}),". Schemas are used to validate a specific data type like a string, object or date. They are the starting point for using Valibot."]}),`
`,e(n.p,{children:["Methods help you either modify or use a schema. For example, the new ",e(s,{href:"/api/pipe/",children:e(n.code,{children:"pipe"})})," method extends the functionality of a schema by adding additional validation and transformation rules. When using a method, you always pass a schema as the first argument."]}),`
`,e(n.p,{children:"Finally, there are actions. Actions are used exclusively in the pipeline of a schema. They can be used to further validate or transform a particular data type. For example, the following schema can be used to trim a string and check if it is a valid email address."}),`
`,e(D,{alt:"Code example with a schema, method and actions",class:"hidden dark:block"}),`
`,e($,{alt:"Code example with a schema, method and actions",class:"dark:hidden"}),`
`,e(n.blockquote,{children:[`
`,e(n.p,{children:["We recommend using Valibot with a wildcard import as this improves the developer experience. Tree shaking still works when using ",e(n.code,{children:"v."}),". We tested it with various build-systems."]}),`
`]}),`
`,e(n.p,{children:["You can find a list of all schemas, methods and actions in our ",e(s,{href:"/api/",children:"API reference"}),"."]}),`
`,e(n.h2,{id:"bundle-size",children:[e(n.a,{"aria-hidden":"true",tabindex:"-1",href:"#bundle-size",children:e(n.span,{class:"icon icon-link"})}),"Bundle Size"]}),`
`,e(n.p,{children:"After increasing the initial bundle size by introducing new features to the core of Valibot in the past, I am pleased to announce that this release reduces the individual bundle size of your schemas by approximately 15 to 30% without losing any functionality. This has been achieved by simplifying and unifying the internal structure and implementation."}),`
`,e(n.p,{children:["For example, the ",e(s,{href:"/api/string/",children:e(n.code,{children:"string"})})," schema required 800 bytes in the previous version, while the same schema now requires only 560 bytes. This is a reduction of 30%. As the library is optimized for compression, and most of these bytes are shared across all schemas and actions, the bundle size increases only slightly when adding more schemas or actions."]}),`
`,e(F,{alt:"Comparison of string schema bundle size between v0.30.0 and v0.31.0",class:"hidden dark:block"}),`
`,e(H,{alt:"Comparison of string schema bundle size between v0.30.0 and v0.31.0",class:"dark:hidden"}),`
`,e(n.p,{children:["For example, adding the ",e(s,{href:"/api/number/",children:e(n.code,{children:"number"})})," schema increases the bundle size by only 40 bytes, resulting in a total bundle size of 600 bytes. This is a huge improvement and makes Valibot even more attractive when using schemas to validate unknown data in the browser, on the edge, or in serverless environments. A smaller bundle size can greatly improve the startup performance of your application by reducing the time it takes to download and parse the JavaScript code."]}),`
`,e(n.blockquote,{children:[`
`,e(n.p,{children:"I am planning an experimental library with the same external API but slightly less functionality. If it works out, it could become a drop-in replacement if you do not need the full functionality of Valibot. I expect the initial bundle size of this library to start around 200 bytes. Stay tuned!"}),`
`]}),`
`,e(n.h2,{id:"flexibility",children:[e(n.a,{"aria-hidden":"true",tabindex:"-1",href:"#flexibility",children:e(n.span,{class:"icon icon-link"})}),"Flexibility"]}),`
`,e(n.p,{children:["Another huge improvement is the flexibility gained by our new ",e(s,{href:"/api/pipe/",children:e(n.code,{children:"pipe"})})," method. Compared to the previous versions, we removed many limitation. For example, it is now possible to transform the data type inside of pipelines. This simplifies the usage and readability as it reduces function nesting."]}),`
`,e(n.pre,{class:"language-ts",children:e(n.code,{class:"language-ts",children:[e(n.span,{class:"token comment",children:"// With the previous API"}),`
`,e(n.span,{class:"token keyword",children:"const"})," ",e(n.span,{class:"token maybe-class-name",children:"BirthdaySchema"})," ",e(n.span,{class:"token operator",children:"="})," v",e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"brand"}),e(n.span,{class:"token punctuation",children:"("}),`
  v`,e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"transform"}),e(n.span,{class:"token punctuation",children:"("}),"v",e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"string"}),e(n.span,{class:"token punctuation",children:"("}),e(n.span,{class:"token punctuation",children:"["}),"v",e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"isoDate"}),e(n.span,{class:"token punctuation",children:"("}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:"]"}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:","})," ",e(n.span,{class:"token punctuation",children:"("}),"input",e(n.span,{class:"token punctuation",children:")"})," ",e(n.span,{class:"token arrow operator",children:"=>"})," ",e(n.span,{class:"token keyword",children:"new"})," ",e(n.span,{class:"token class-name",children:e(n.span,{class:"token known-class-name class-name",children:"Date"})}),e(n.span,{class:"token punctuation",children:"("}),"input",e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:","}),`
  `,e(n.span,{class:"token string",children:"'birthday'"}),`
`,e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:";"}),`

`,e(n.span,{class:"token comment",children:"// With the brand new API"}),`
`,e(n.span,{class:"token keyword",children:"const"})," ",e(n.span,{class:"token maybe-class-name",children:"BirthdaySchema"})," ",e(n.span,{class:"token operator",children:"="})," v",e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"pipe"}),e(n.span,{class:"token punctuation",children:"("}),`
  v`,e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"string"}),e(n.span,{class:"token punctuation",children:"("}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:","}),`
  v`,e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"isoDate"}),e(n.span,{class:"token punctuation",children:"("}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:","}),`
  v`,e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"transform"}),e(n.span,{class:"token punctuation",children:"("}),e(n.span,{class:"token punctuation",children:"("}),"input",e(n.span,{class:"token punctuation",children:")"})," ",e(n.span,{class:"token arrow operator",children:"=>"})," ",e(n.span,{class:"token keyword",children:"new"})," ",e(n.span,{class:"token class-name",children:e(n.span,{class:"token known-class-name class-name",children:"Date"})}),e(n.span,{class:"token punctuation",children:"("}),"input",e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:","}),`
  v`,e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"brand"}),e(n.span,{class:"token punctuation",children:"("}),e(n.span,{class:"token string",children:"'birthday'"}),e(n.span,{class:"token punctuation",children:")"}),`
`,e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:";"}),`
`]})}),`
`,e(n.p,{children:"Furthermore, it is now possible to extend the pipeline of an existing schema by adding additional validation and transformation rules. This makes it possible to reuse already created schemas to construct more specific ones. Similar to how you extend a class in object-oriented programming to make it more specialized."}),`
`,e(n.pre,{class:"language-ts",children:e(n.code,{class:"language-ts",children:[e(n.span,{class:"token keyword",children:"const"})," ",e(n.span,{class:"token maybe-class-name",children:"EmailSchema"})," ",e(n.span,{class:"token operator",children:"="})," v",e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"pipe"}),e(n.span,{class:"token punctuation",children:"("}),"v",e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"string"}),e(n.span,{class:"token punctuation",children:"("}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:","})," v",e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"email"}),e(n.span,{class:"token punctuation",children:"("}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:";"}),`
`,e(n.span,{class:"token keyword",children:"const"})," ",e(n.span,{class:"token maybe-class-name",children:"GmailSchema"})," ",e(n.span,{class:"token operator",children:"="})," v",e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"pipe"}),e(n.span,{class:"token punctuation",children:"("}),e(n.span,{class:"token maybe-class-name",children:"EmailSchema"}),e(n.span,{class:"token punctuation",children:","})," v",e(n.span,{class:"token punctuation",children:"."}),e(n.span,{class:"token method function property-access",children:"endsWith"}),e(n.span,{class:"token punctuation",children:"("}),e(n.span,{class:"token string",children:"'@gmail.com'"}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:")"}),e(n.span,{class:"token punctuation",children:";"}),`
`]})}),`
`,e(n.h2,{id:"type-safety",children:[e(n.a,{"aria-hidden":"true",tabindex:"-1",href:"#type-safety",children:e(n.span,{class:"icon icon-link"})}),"Type safety"]}),`
`,e(n.p,{children:"After I started working on a first draft in early March, I spent at least two weeks thinking about the structure and interplay of everything. I also thought a lot about the type safety of the library."}),`
`,e(n.p,{children:["Previously, many parts were only typed generically. An example is the issues that a schema returns when parsing invalid data. Even though each issue contains very specific data depending on the schema or action, they were all previously typed as a generic ",e(n.code,{children:"SchemaIssue"}),"."]}),`
`,e(n.p,{children:"This changes with this release. Wherever possible, we have tried to achieve 100% type safety. You can even infer the issue type of any schema or action used. We expect this improvement to result in a better developer experience and fewer bugs."}),`
`,e(y,{alt:"Code example showing how the issue type of a schema is automatically inferred",class:"hidden dark:block"}),`
`,e(w,{alt:"Code example showing how the issue type of a schema is automatically inferred",class:"dark:hidden"}),`
`,e(n.h2,{id:"stability",children:[e(n.a,{"aria-hidden":"true",tabindex:"-1",href:"#stability",children:e(n.span,{class:"icon icon-link"})}),"Stability"]}),`
`,e(n.p,{children:"Once most of the decisions were made, we spent a lot of time writing unit and type tests. This explains why it took us two and a half months to release the first release candidate. The tests have allowed us to fix some previously undetected bugs and enhance the stability of the library in the long run."}),`
`,e(n.p,{children:"Before v1, I would like to further improve the test coverage to be able to fully guarantee the functionality of each function. This is an ambitious goal, but I am confident that we will reach it soon."}),`
`,e(n.h2,{id:"thank-you",children:[e(n.a,{"aria-hidden":"true",tabindex:"-1",href:"#thank-you",children:e(n.span,{class:"icon icon-link"})}),"Thank you!"]}),`
`,e(n.p,{children:"This release was a team effort! Because so many of you contributed to this release in so many different ways, I am not able to mention everyone. However, I have tried to link all of your GitHub profiles and highlight some very important contributions. Please ping me if your avatar is missing."}),`
`,e("ul",{class:"mx-8! mt-10! list-none! md:mt-12! lg:mx-10! lg:mt-14! flex flex-wrap gap-2 lg:gap-3",children:["Afsoon","AlexXanderGrib","Andarist","AndreyYolkin","ariskemper","colinhacks","Demivan","DylanThomasFr","EltonLobo07","GabrielHangor","Hugos68","IlyaSemenov","MohammedEsafi","MrGeniusProgrammer","Saeris","Sandros94","Sec-ant","alexbit-codemod","ammarriq","anuraghazra","arybitskiy","bingtsingw","brandonpittman","brenelz","chertik77","chimame","christophsturm","dboune","devcaeg","dusty","fredericoo","gmaxlev","homersimpsons","jansedlon","jchatard","joshwashywash","jsudelko","juliusmarminge","kovalchukq","linkb15","lukemorton","macarie","morgante","mtt-artis","mutewinter","mxdvl","nakanoasaservice","naveen-bharathi","sacrosanctic","samualtnorman","saturnonearth","seren5240","sillvva","ssalbdivad","vladshcherbin","xcfox","yudinmaxim","znycheporuk"].map(a=>e("li",{class:"m-0! p-0!",children:e("a",{href:`https://github.com/${a}`,target:"_blank",rel:"noreferrer",children:e("img",{width:"88",height:"88",loading:"lazy",src:`https://github.com/${a}.png?size=88`,alt:`GitHub profile picture of @${a}`,class:"w-9 rounded-full md:w-10 lg:w-11"})})},a))}),`
`,e(n.p,{children:["Thanks to ",e("a",{href:"https://github.com/Demivan",children:"@Demivan"})," and ",e("a",{href:"https://github.com/xcfox",children:"@xcfox"})," for their contributions to the new API design. ",e("a",{href:"https://github.com/Demivan",children:"@Demivan"})," had the initial idea for the ",e(s,{href:"/api/pipe/",children:e(n.code,{children:"pipe"})})," method and helped me with many decisions along the way. Thanks to ",e("a",{href:"https://github.com/ariskemper",children:"@ariskemper"})," for influencing the new structure of our unit tests, thanks to ",e("a",{href:"https://github.com/EltonLobo07",children:"@EltonLobo07"})," for porting over 25 actions to the new implementation and thanks to ",e("a",{href:"https://github.com/anuraghazra",children:"@anuraghazra"})," for finding a TypeScript workaround that made the new ",e(s,{href:"/api/pipe/",children:e(n.code,{children:"pipe"})})," method possible in this way."]}),`
`,e(n.p,{children:["I would also like to thank our partners and sponsors who provide intellectual and financial support to the project. In particular, I would like to thank the ",e("a",{href:"https://www.pace.edu/seidenberg",children:"Seidenberg School of Computer Science and Information Systems"})," at Pace University. Without their support over the past few months, this release would not have been possible."]}),`
`,e(n.blockquote,{children:[`
`,e(n.p,{children:["Please ",e("a",{href:"mailto:hello@fabianhiller.com",children:"contact us"})," if your organization is interested in becoming a partner of Valibot to help us ensure the long-term development and maintenance of the project."]}),`
`]})]})}const U=(t={})=>{const n=l(r,{children:l(R,t,3,null)},3,"d68L03z5");return typeof MDXLayout=="function"?e(MDXLayout,{children:n}):n};export{U as default,Y as frontmatter,E as head,X as headings};
