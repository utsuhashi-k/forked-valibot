const E=(w,q)=>{const t=window,s="_qCitySPA",u="_qCityInitPopstate",d="_qCityInitAnchors",y="_qCityInitVisibility",f="_qCityInitScroll";if(!t[s]&&!t[u]&&!t[d]&&!t[y]&&!t[f]){const _=location.pathname+location.search,m="_qCityHistoryPatch",C="_qCityBootstrap",c="_qCityScrollEnabled",l="_qCityScrollDebounce",S="_qCityScroll",v=o=>{o&&t.scrollTo(o.x,o.y)},p=()=>{const o=document.documentElement;return{x:o.scrollLeft,y:o.scrollTop,w:Math.max(o.scrollWidth,o.clientWidth),h:Math.max(o.scrollHeight,o.clientHeight)}},h=o=>{const i=history.state||{};i[S]=o||p(),history.replaceState(i,"")};if(h(),t[u]=()=>{if(!t[s]){if(t[c]=!1,clearTimeout(t[l]),_!==location.pathname+location.search){const o=r=>r.closest("[q\\:container]"),i=o(q)?.querySelector("a[q\\:link]");if(i){const r=o(i),e=i.cloneNode();e.setAttribute("q:nbs",""),e.style.display="none",r.appendChild(e),t[C]=e,e.click()}else location.reload()}else if(history.scrollRestoration==="manual"){const o=history.state?.[S];v(o),t[c]=!0}}},!t[m]){t[m]=!0;const o=history.pushState,i=history.replaceState,r=e=>(e===null||typeof e>"u"?e={}:e?.constructor!==Object&&(e={_data:e}),e._qCityScroll=e._qCityScroll||p(),e);history.pushState=(e,n,a)=>(e=r(e),o.call(history,e,n,a)),history.replaceState=(e,n,a)=>(e=r(e),i.call(history,e,n,a))}t[d]=o=>{if(t[s]||o.defaultPrevented)return;const i=o.target.closest("a[href]");if(i&&!i.hasAttribute("preventdefault:click")){const r=i.getAttribute("href"),e=new URL(location.href),n=new URL(r,e),a=n.origin===e.origin,g=n.pathname+n.search===e.pathname+e.search;if(a&&g)if(o.preventDefault(),n.href!==e.href&&history.pushState(null,"",n),!n.hash)n.href.endsWith("#")?window.scrollTo(0,0):(t[c]=!1,clearTimeout(t[l]),h({...p(),x:0,y:0}),location.reload());else{const T=n.hash.slice(1),b=document.getElementById(T);b&&b.scrollIntoView()}}},t[y]=()=>{!t[s]&&t[c]&&document.visibilityState==="hidden"&&h()},t[f]=()=>{t[s]||!t[c]||(clearTimeout(t[l]),t[l]=setTimeout(()=>{h(),t[l]=void 0},200))},t[c]=!0,setTimeout(()=>{t.addEventListener("popstate",t[u]),t.addEventListener("scroll",t[f],{passive:!0}),document.addEventListener("click",t[d]),t.navigation||document.addEventListener("visibilitychange",t[y],{passive:!0})},0)}};export{E as s_nF51rW0Tb78};
